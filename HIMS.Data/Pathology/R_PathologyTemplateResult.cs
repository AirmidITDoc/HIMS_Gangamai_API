using HIMS.Common.Utility;
using HIMS.Model.IPD;
using HIMS.Model.Pathology;
using System;
using System.Collections.Generic;
using System.Data;
using System.Data.SqlClient;
using System.IO;
using System.Text;

namespace HIMS.Data.Pathology
{
    public class R_PathologyTemplateResult:GenericRepository,I_PathologyTemplateResult
    {
        public R_PathologyTemplateResult(IUnitofWork unitofWork) : base(unitofWork)
        {

        }

        public bool Insert(PathologyTemplateResultParams PathologyTemplateResultParams)
        {
            var disc3 = PathologyTemplateResultParams.DeletePathologyReportTemplateDetails.ToDictionary();
            var PathReportId = disc3["PathReportId"];
            ExecNonQueryProcWithOutSaveChanges("Delete_T_PathologyReportTemplateDetails", disc3);

            
            foreach (var a in PathologyTemplateResultParams.InsertPathologyReportTemplateDetails)
            {
                
                var disc1 = a.ToDictionary();
                disc1["PathReportId"] = (int)Convert.ToInt64(PathReportId);
                ExecNonQueryProcWithOutSaveChanges("insert_PathologyReportTemplateDetails_1", disc1);
            }

            //PathologyTemplateResultParams.UpdatePathologyReportHeader.PathReportID = PathologyTemplateResultParams.
            var disc = PathologyTemplateResultParams.UpdatePathTemplateReportHeader.ToDictionary();
            disc["PathReportID"] = (int)Convert.ToInt64(PathReportId);
            ExecNonQueryProcWithOutSaveChanges("update_T_PathologyReportHeader_1", disc);
//<div innerHTML="<li class="b_ans b_top b_topborder" data-tag="" data-partnertag="" data-id="" data-fbhlsel="li.b_ans.b_top" h="SERP,5486.1" data-bm="6" style="border: none; border-collapse: collapse; border-spacing: 0px; list-style: none; margin-right: 0px; margin-bottom: 22px; margin-left: 0px; padding: 15px 19px 10px; color: rgb(68, 68, 68); border-radius: 6px; box-shadow: rgba(0, 0, 0, 0.05) 0px 0px 0px 1px; position: relative; font-family: Roboto, Helvetica, sans-serif; margin-top: 25px !important;"><div class="b_sideBleed b_topBleed b_bottomBleed" style="margin: -15px -19px -10px;"><div id="wellness_mainline_wrapper" style="position: relative;"><div class="wellness-mainline-wrapper healthqna" style="position: relative; cursor: pointer;"><div class="healtheditorial_cls HealthQnaANNconditionreference wellness-answer-style" id="wellness_container" data-priority="" data-npswowid="" style="padding-bottom: 5px;"><div class="b_antiTopBleed" id="d_ans" style="padding-top: 15px;"><div class="b_antiSideBleed" style="padding-left: 19px; padding-right: 19px;"><div class="healthContainer" data-fbhlsel=".healthContainer" style="border-top: none;"><div class="df_listaa" style="border: none; margin-bottom: 0px; border-radius: 6px;"><div class="b_vPanel"><div style="padding-bottom: 0px;"><div class="df_con" data-tag="Health.ItemDetails" style="margin-bottom: 0px;"><div class=""><div class="df_alsocon " data-tag="Health.ItemDetails" style="overflow: visible; padding: 0px;"><div class="rwrl rwrl_small" style="font-family: Roboto, sans-serif; font-size: 13px; line-height: 1.31; font-stretch: normal; padding-bottom: 12px !important;"><span style="display: inline-block; font-size: 20px; line-height: 24px; text-transform: initial; width: 518.5px;"><a target="_blank" href="https://www.bing.com/ck/a?!&amp;&amp;p=ee30f44bccbf5f65JmltdHM9MTcyMTAwMTYwMCZpZ3VpZD0wNDAyNWQ1ZC04OWQzLTYyNDctMjQ2Ni00OTcyODgwMTYzMjcmaW5zaWQ9NTQ4OQ&amp;ptn=3&amp;ver=2&amp;hsh=3&amp;fclid=04025d5d-89d3-6247-2466-497288016327&amp;u=a1aHR0cHM6Ly93d3cuYmluZy5jb20vc2VhcmNoP3E9V2hhdCtpcyt0aGUrZGVmaW5pdGlvbitvZitwYXRob2xvZ3k_JmZvcm09aGx0aHFhJmZpbHRlcnM9SXNIZWFsdGhFeHBSZXF1ZXJ5OiUyMlRydWUlMjIrQW5zSWQ6JTIyMTk0MzA0NyUyMg&amp;ntb=1" h="ID=SERP,5489.1" hover-url="https://www.bing.com/search?q=What+is+the+definition+of+pathology?&amp;form=hlthqa&amp;filters=IsHealthExpRequery:&quot;True&quot;+AnsId:&quot;1943047&quot;" state="" style="color: rgb(64, 7, 162);"><h2 class="" style="border: 0px; border-collapse: collapse; border-spacing: 0px; list-style: none; margin-bottom: 0px; padding: 0px; font-weight: normal; font-size: 20px; line-height: 28px; font-family: Roboto, sans-serif;">What is the definition of pathology?</h2></a><span class="health-qna-verified-text" style="font-weight: 700; color: rgb(17, 17, 17); display: block; line-height: 22px; height: 22px; font-size: 14px; margin-top: 8px;">Answered by verified global health professionals<img id="" title="" src="https://www.bing.com/th?id=OSAHI.D3FE59E4BF288394CEE03FF438ECDF40&amp;w=24&amp;p=0" alt="" loading="lazy" data-bm="54" style="border-width: 0px; border-style: initial; border-collapse: collapse; border-spacing: 0px; list-style: none; margin: 0px 0px 0px 4px; padding: 0px; width: 12px; height: 12px; vertical-align: middle;"></span></span></div></div><div class="df_alsocon " data-tag="Health.ItemDetails" style="overflow: visible; padding: 0px;"><div class="rwrl rwrl_small" style="font-family: Roboto, sans-serif; font-size: 13px; line-height: 1.31; font-stretch: normal; padding-bottom: 12px !important;"><span style="display: inline-block; width: 80px; height: 104px; vertical-align: top;"><img id="" title="" src="https://www.bing.com/th?id=OSAHI.FF869508324BB793D82CE03C95F789A9&amp;w=100&amp;p=0" alt="" loading="lazy" data-bm="55" style="border-width: 0px; border-style: initial; border-collapse: collapse; border-spacing: 0px; list-style: none; margin: 0px; padding: 0px; width: 80px; height: 104px; border-radius: 4px; object-fit: cover; object-position: 50% 20%;"></span><span style="display: inline-block; width: calc(100% - 92px); margin-left: 12px;"><span class="health-qna-expert-title" style="font-weight: 700; color: rgb(17, 17, 17); display: inline-block; font-size: 16px; line-height: 22px; padding-bottom: 2px; margin-right: 8px;"><a target="_blank" href="https://www.bing.com/ck/a?!&amp;&amp;p=48f5d115bc6acc0cJmltdHM9MTcyMTAwMTYwMCZpZ3VpZD0wNDAyNWQ1ZC04OWQzLTYyNDctMjQ2Ni00OTcyODgwMTYzMjcmaW5zaWQ9NTQ5Mg&amp;ptn=3&amp;ver=2&amp;hsh=3&amp;fclid=04025d5d-89d3-6247-2466-497288016327&amp;psq=pathology+meaning&amp;u=a1aHR0cHM6Ly9taWNyb3NvZnRzdGFydC5tc24uY29tL2VuLWluL2hlYWx0aC9leHBlcnQtY29tbXVuaXR5L2luLVJpbnRhLU0tQmFidS9pbi0xOTQzMDQ3&amp;ntb=1" h="ID=SERP,5492.1" hover-url="https://microsoftstart.msn.com/en-in/health/expert-community/in-Rinta-M-Babu/in-1943047" state="" style="color: rgb(64, 7, 162); text-decoration-color: rgb(17, 17, 17);"><h3 style="border: 0px; border-collapse: collapse; border-spacing: 0px; list-style: none; margin-bottom: 0px; padding: 0px; font-weight: 700; font-size: 16px; line-height: 22px; font-family: Roboto, sans-serif; color: rgb(17, 17, 17); text-overflow: ellipsis; overflow: hidden; text-wrap: nowrap;">Dr. Rinta M Babu</h3></a></span><a class="rb_btnLink" target="_blank" href="https://www.bing.com/ck/a?!&amp;&amp;p=831503462be3c905JmltdHM9MTcyMTAwMTYwMCZpZ3VpZD0wNDAyNWQ1ZC04OWQzLTYyNDctMjQ2Ni00OTcyODgwMTYzMjcmaW5zaWQ9NTkzNQ&amp;ptn=3&amp;ver=2&amp;hsh=3&amp;fclid=04025d5d-89d3-6247-2466-497288016327&amp;psq=pathology+meaning&amp;u=a1aHR0cHM6Ly9taWNyb3NvZnRzdGFydC5tc24uY29tL2VuLWluL2hlYWx0aC9leHBlcnQtY29tbXVuaXR5L2luLVJpbnRhLU0tQmFidS9pbi0xOTQzMDQ3&amp;ntb=1" h="ID=SERP,5935.1" hover-url="https://microsoftstart.msn.com/en-in/health/expert-community/in-Rinta-M-Babu/in-1943047" state="" style="color: rgb(64, 7, 162); margin-right: 8px;"><img id="" title="Dr. Rinta M Babu" src="https://www.bing.com/th?id=OSAHI.131A323B125BC6C370457007918E3BDE&amp;w=32&amp;p=0" alt="Dr. Rinta M Babu community page" loading="lazy" data-bm="56" style="border-width: 0px; border-style: initial; border-collapse: collapse; border-spacing: 0px; list-style: none; margin: 3px 0px 0px; padding: 0px; width: 16px; height: 16px;"></a><span style="line-height: 20px; padding-bottom: 4px; -webkit-line-clamp: 1; overflow: hidden; display: -webkit-box; -webkit-box-orient: vertical; text-overflow: ellipsis;">MBBS · 2 years of exp</span><span id="healthqna_ans1" class="health-qna-expert-ans" style="color: rgb(102, 102, 102); font-size: 14px; line-height: 22px; cursor: pointer;">The definition of pathology is the branch of medicine that deals with the causes and effects of various disease conditions, analyzed by various blood tests, examination of tissues...</span><span id="healthqna_ans1_readmore" style="line-height: 22px; font-size: 14px;"><a target="_blank" aria-label="Read complete answer by Dr. Rinta M Babu" href="https://www.bing.com/ck/a?!&amp;&amp;p=711a22af73e5ad4cJmltdHM9MTcyMTAwMTYwMCZpZ3VpZD0wNDAyNWQ1ZC04OWQzLTYyNDctMjQ2Ni00OTcyODgwMTYzMjcmaW5zaWQ9NTQ5Mw&amp;ptn=3&amp;ver=2&amp;hsh=3&amp;fclid=04025d5d-89d3-6247-2466-497288016327&amp;u=a1aHR0cHM6Ly93d3cuYmluZy5jb20vc2VhcmNoP3E9V2hhdCtpcyt0aGUrZGVmaW5pdGlvbitvZitwYXRob2xvZ3k_JmZvcm09aGx0aHFhJmZpbHRlcnM9SXNIZWFsdGhFeHBSZXF1ZXJ5OiUyMlRydWUlMjIrQW5zSWQ6JTIyMTk0MzA0NyUyMg&amp;ntb=1" h="ID=SERP,5493.1" hover-url="https://www.bing.com/search?q=What+is+the+definition+of+pathology?&amp;form=hlthqa&amp;filters=IsHealthExpRequery:&quot;True&quot;+AnsId:&quot;1943047&quot;" state="" style="color: rgb(64, 7, 162);">Read more</a></span></span></div></div></div></div></div></div></div></div><div class="related-qna-hpanel" style="margin-bottom: 8px;"><div class="question-box"><div id="get-answer-header" style="font-family: Roboto; font-weight: 700; line-height: 22px; margin-bottom: 12px;">Get answers from health professionals</div></div><div class="b_hPanel" style="display: flex;"><span style="display: inline-block; padding-right: 10px; vertical-align: top; flex: 1 1 0%;"><input type="text" id="relatedqna_input" name="RelatedQnA_QuestionText" maxlength="150" class="ctxt" data-gt="" placeholder="Your question will be posted publicly as anonymous user." style="font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; line-height: inherit; font-family: inherit; font-optical-sizing: inherit; font-kerning: inherit; font-feature-settings: inherit; font-variation-settings: inherit; font-size: 14px; color: rgb(68, 68, 68); border-color: rgb(221, 221, 221); padding-right: 11px; padding-left: 11px; height: 32px; border-width: 1px; border-style: solid; border-radius: 4px; vertical-align: middle; left: 0px; top: 0px; width: 476px;"></span><span style="display: inline-block; padding-right: 0px; vertical-align: top;"><span id="7A53E6_26_btn" class="cbtn" data-appns="SERP" data-k="5939.1"><input type="submit" name="submit" id="qna_submit" value="Post question" aria-label="" style="font-style: inherit; font-variant: inherit; font-weight: normal; font-stretch: inherit; line-height: 30px; font-family: inherit; font-optical-sizing: inherit; font-kerning: inherit; font-feature-settings: inherit; font-variation-settings: inherit; font-size: inherit; border-radius: 4px; border-width: 1px; border-style: solid; border-color: rgb(221, 221, 221); min-width: 50px; max-width: 100%; padding-right: 12px; padding-left: 12px; cursor: pointer; color: rgb(102, 102, 102); background: rgb(245, 245, 245); height: 32px; vertical-align: middle;"></span></span></div></div><div id="qna_ajax_load_div"></div><div class="b_footnote related-qna-footnote" style="color: rgb(118, 118, 118); padding-bottom: 10px; font-size: 11px; line-height: 16px; margin-top: 8px;">Disclaimer: Opinions are from external health professionals and should not be considered as Microsoft's opinion or a substitute for professional help. Consult a health professional for medical advice.</div></div></div><div class="fbtopblue" id="fbtop" style="position: absolute; bottom: -19px; right: 19px;"><div class="b_footnote" style="color: rgb(118, 118, 118); padding: 0px; font-size: 11px; line-height: 16px;">Was this helpful?<a id="fbtoptu" class="hlig feedback-binded" aria-label="Thumbs up" role="button" h="ID=SERP,5496.1" style="color: rgb(64, 7, 162); margin-left: 12px; padding: 0px;"><div class="fbtopt" id="fbtoptui" role="presentation" aria-hidden="true" style="display: inline-block; vertical-align: middle; height: 12px; width: 12px; padding: 0px;"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 12"><path d="M2.245 5H1v4.955h1.245L3 9.973a4.322 4.322 0 0 1 .507.07 5.016 5.016 0 0 1 .847.258 5.23 5.23 0 0 0 2.021.4h3a1.123 1.123 0 0 0 .349-.056 1.151 1.151 0 0 0 .307-.155 1.051 1.051 0 0 0 .246-.243 1.142 1.142 0 0 0 .164-.313l1.5-4.438A1.115 1.115 0 0 0 12 5.138a1.1 1.1 0 0 0-.088-.439 1.135 1.135 0 0 0-.243-.358 1.182 1.182 0 0 0-.36-.24 1.1 1.1 0 0 0-.434-.087h-2.6a2.493 2.493 0 0 1 .111-.511A4.242 4.242 0 0 1 8.578 3a4.208 4.208 0 0 0 .31-.853 3.774 3.774 0 0 0 .106-.9.888.888 0 0 0-.075-.372.939.939 0 0 0-.2-.3.97.97 0 0 0-.3-.2A.929.929 0 0 0 8.057.3.741.741 0 0 0 7.7.382a1.386 1.386 0 0 0-.293.229L3 5z" fill="#919191"></path></svg></div></a><a id="fbtoptd" class="hlig feedback-binded" aria-label="Thumbs down" role="button" h="ID=SERP,5497.1" style="color: rgb(64, 7, 162); margin-left: 12px; padding: 0px;"><div class="fbtopt" id="fbtoptdi" role="presentation" aria-hidden="true" style="display: inline-block; vertical-align: middle; height: 12px; width: 12px; transform: rotate(180deg); padding: 0px;"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 12"><path d="M2.245 5H1v4.955h1.245L3 9.973a4.322 4.322 0 0 1 .507.07 5.016 5.016 0 0 1 .847.258 5.23 5.23 0 0 0 2.021.4h3a1.123 1.123 0 0 0 .349-.056 1.151 1.151 0 0 0 .307-.155 1.051 1.051 0 0 0 .246-.243 1.142 1.142 0 0 0 .164-.313l1.5-4.438A1.115 1.115 0 0 0 12 5.138a1.1 1.1 0 0 0-.088-.439 1.135 1.135 0 0 0-.243-.358 1.182 1.182 0 0 0-.36-.24 1.1 1.1 0 0 0-.434-.087h-2.6a2.493 2.493 0 0 1 .111-.511A4.242 4.242 0 0 1 8.578 3a4.208 4.208 0 0 0 .31-.853 3.774 3.774 0 0 0 .106-.9.888.888 0 0 0-.075-.372.939.939 0 0 0-.2-.3.97.97 0 0 0-.3-.2A.929.929 0 0 0 8.057.3.741.741 0 0 0 7.7.382a1.386 1.386 0 0 0-.293.229L3 5z" fill="#919191"></path></svg></div></a></div></div></div></div><div id="HealthWidgetContainer" class="b_widgetContainer slide-in" data-priority="2" style="transition-property: visibility; transition-delay: 0s; transition-duration: 0s; position: absolute; visibility: visible; top: 0px; left: -33px; background-color: rgb(242, 242, 242); border-radius: 0px 16px 16px 0px; width: 144px; margin: 8px 16px 16px; padding: 12px 0px 10px; z-index: 1; overflow: hidden; max-height: 302px; animation: 1s ease 0s 1 normal forwards running slide-in-ltr !important;"><nav role="navigation" aria-label="Explore Start Health"><div class="lg-health-widget-header" style="display: flex; flex-direction: column; align-items: flex-start; padding: 0px 8px;"><div class="lg-health-widget-header-top" style="display: flex; align-items: center; justify-content: space-between; align-self: stretch; padding: 0px 4px;"><a title="Start Health" class="lg-microsoft-logo-url" id="lg_ms_logo" target="_blank" href="https://www.bing.com/ck/a?!&amp;&amp;p=e6469366a0fac1daJmltdHM9MTcyMTAwMTYwMCZpZ3VpZD0wNDAyNWQ1ZC04OWQzLTYyNDctMjQ2Ni00OTcyODgwMTYzMjcmaW5zaWQ9NTUwMQ&amp;ptn=3&amp;ver=2&amp;hsh=3&amp;fclid=04025d5d-89d3-6247-2466-497288016327&amp;psq=pathology+meaning&amp;u=a1aHR0cHM6Ly93d3cubXNuLmNvbS9lbi1pbi9oZWFsdGgvPyZzb3VyY2U9aGVhbHRocW5hbGc&amp;ntb=1" h="ID=SERP,5501.1" style="color: rgb(64, 7, 162); border-radius: 22px; border: 1px solid rgba(0, 0, 0, 0.1); padding: 6px 8px; background-color: rgb(255, 255, 255); height: 30px; width: 30px; display: flex; align-items: center;"><img alt="Health Left Gutter Microsoft Logo" class="lg-microsoft-logo rms_img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAuElEQVR4AeVTOwoCMRScWQPbWCraa2vhCcRKFBR7T2KlYGnvAbT2IF5A8BI2tsKYLAt+NskuaOcQXvEmbzJ5vMfbtCMCED5gE8nuiO25D7LAZliNQCMJftppCPkJIsGXyARIP0lUFFDAoyRUEgjCWiuTKO0BX6KPMRjMEHrd1JvotRfWRfKsebO0h1kPN4Va5WGZAvO0gahDHq7eb7rkZXJH99Syt/ydqI3B38zB3wvEBt4tCeMb8QB+5idIXPO1JAAAAABJRU5ErkJggg==" data-bm="58" style="border-width: 0px; border-style: initial; border-collapse: collapse; border-spacing: 0px; list-style: none; margin: 0px; padding: 0px; width: 12px; height: 12px;"></a><a title="Start Health" id="lg_new_page_icon" target="_blank" href="https://www.bing.com/ck/a?!&amp;&amp;p=e6469366a0fac1daJmltdHM9MTcyMTAwMTYwMCZpZ3VpZD0wNDAyNWQ1ZC04OWQzLTYyNDctMjQ2Ni00OTcyODgwMTYzMjcmaW5zaWQ9NTUwMQ&amp;ptn=3&amp;ver=2&amp;hsh=3&amp;fclid=04025d5d-89d3-6247-2466-497288016327&amp;psq=pathology+meaning&amp;u=a1aHR0cHM6Ly93d3cubXNuLmNvbS9lbi1pbi9oZWFsdGgvPyZzb3VyY2U9aGVhbHRocW5hbGc&amp;ntb=1" h="ID=SERP,5501.2" style="color: rgb(64, 7, 162);"><svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M2.49999 1C1.67157 1 0.999995 1.67157 0.999995 2.5V9.5C0.999995 10.3284 1.67157 11 2.49999 11H9.49996C10.3284 11 10.9999 10.3284 10.9999 9.5V7.26923C10.9999 6.99309 11.2238 6.76923 11.4999 6.76923C11.7761 6.76923 11.9999 6.99309 11.9999 7.26923V9.5C11.9999 10.8807 10.8807 12 9.49996 12H2.49999C1.11928 12 0 10.8807 0 9.5V2.5C0 1.11929 1.11928 0 2.49999 0H4.73075C5.00689 0 5.23074 0.223858 5.23074 0.5C5.23074 0.776142 5.00689 1 4.73075 1H2.49999ZM6.76926 0.5C6.76926 0.223858 6.99311 0 7.26925 0H11.5C11.7761 0 12 0.223858 12 0.5V4.73077C12 5.00691 11.7761 5.23077 11.5 5.23077C11.2239 5.23077 11 5.00691 11 4.73077V1.70711L7.6228 5.08433C7.42754 5.27959 7.11096 5.27959 6.9157 5.08433C6.72044 4.88906 6.72044 4.57248 6.9157 4.37722L10.2929 1H7.26925C6.99311 1 6.76926 0.776142 6.76926 0.5Z" fill="#666666"></path></svg></a></div><h2 class=" lg-health-widget-title" style="border: 0px; border-collapse: collapse; border-spacing: 0px; list-style: none; margin-top: 8px; margin-bottom: 0px; margin-left: 8px; padding: 0px; font-size: 18px; line-height: 22px; font-family: Roboto, sans-serif; display: flex; align-items: center; color: rgb(17, 17, 17) !important;"><a target="_blank" href="https://www.bing.com/ck/a?!&amp;&amp;p=e6469366a0fac1daJmltdHM9MTcyMTAwMTYwMCZpZ3VpZD0wNDAyNWQ1ZC04OWQzLTYyNDctMjQ2Ni00OTcyODgwMTYzMjcmaW5zaWQ9NTUwMQ&amp;ptn=3&amp;ver=2&amp;hsh=3&amp;fclid=04025d5d-89d3-6247-2466-497288016327&amp;psq=pathology+meaning&amp;u=a1aHR0cHM6Ly93d3cubXNuLmNvbS9lbi1pbi9oZWFsdGgvPyZzb3VyY2U9aGVhbHRocW5hbGc&amp;ntb=1" h="ID=SERP,5501.3" style="color: rgb(64, 7, 162);">Start Health</a></h2><div title="Your one-stop destination for all things health." class="lg-health-widget-description" style="font-size: 12px; line-height: 14px; margin: 6px 8px 0px; color: rgb(102, 102, 102);">Your one-stop destination for all things health.</div></div><div class="lg-health-widget-content" style="background-color: rgb(255, 255, 255); border-radius: 0px 10px 10px 0px; padding: 4px 8px 4px 0px; display: flex; flex-direction: column; align-items: flex-start; margin-top: 8px; width: 134px; margin-right: 10px;"><ul style="border: 0px; border-collapse: collapse; border-spacing: 0px; list-style: none; margin: 0px; padding: 0px;"><li style="border: 0px; border-collapse: collapse; border-spacing: 0px; list-style: none; margin: 0px; padding: 0px;"><a title="Health guides" class="lg-health-widget-content-item" data-itemkey="HealthGuidesTxt" data-itemindex="0" target="_blank" href="https://www.bing.com/ck/a?!&amp;&amp;p=ac9ed3684712d682JmltdHM9MTcyMTAwMTYwMCZpZ3VpZD0wNDAyNWQ1ZC04OWQzLTYyNDctMjQ2Ni00OTcyODgwMTYzMjcmaW5zaWQ9NTUwMw&amp;ptn=3&amp;ver=2&amp;hsh=3&amp;fclid=04025d5d-89d3-6247-2466-497288016327&amp;psq=pathology+meaning&amp;u=a1aHR0cHM6Ly93d3cubXNuLmNvbS9lbi1pbi9oZWFsdGgvP3R5cGU9YXRveiZzb3VyY2U9aGVhbHRocW5hbGc&amp;ntb=1" h="ID=SERP,5503.1" style="color: rgb(64, 7, 162); display: flex; flex-direction: row; align-items: center; padding: 0px 8px 0px 16px; gap: 8px; height: 32px; border-radius: 6px; width: 126px;"><div class="lg-health-widget-icon-parent" style="height: 16px; width: 16px;"><div class="lg-health-widget-icon HealthGuides" role="img" aria-label="HealthGuides" style="background-repeat: no-repeat; width: 32px; height: 32px; transform: translate(-7px, -7px) scale(0.5); background-image: url(&quot;/rp/s8oB_GhT-AU9pCcT3SdlZ45IdiY.png&quot;); background-position: -131px -5px;"></div></div><span class="lg-health-widget-content-item-text" style="text-overflow: ellipsis; overflow: hidden; text-wrap: nowrap; font-size: 12px; line-height: 14px; margin-top: 3px; color: rgb(102, 102, 102) !important;">Health guides</span></a></li><li style="border: 0px; border-collapse: collapse; border-spacing: 0px; list-style: none; margin: 0px; padding: 0px;"><a title="Ask an expert" class="lg-health-widget-content-item" data-itemkey="AskExpertTxt" data-itemindex="1" target="_blank" href="https://www.bing.com/ck/a?!&amp;&amp;p=90a706f91f960908JmltdHM9MTcyMTAwMTYwMCZpZ3VpZD0wNDAyNWQ1ZC04OWQzLTYyNDctMjQ2Ni00OTcyODgwMTYzMjcmaW5zaWQ9NTUwNA&amp;ptn=3&amp;ver=2&amp;hsh=3&amp;fclid=04025d5d-89d3-6247-2466-497288016327&amp;psq=pathology+meaning&amp;u=a1aHR0cHM6Ly93d3cubXNuLmNvbS9lbi1pbi9oZWFsdGgvP3R5cGU9YXNrcHJvZiZzb3VyY2U9aGVhbHRocW5hbGc&amp;ntb=1" h="ID=SERP,5504.1" style="color: rgb(64, 7, 162); display: flex; flex-direction: row; align-items: center; padding: 0px 8px 0px 16px; gap: 8px; height: 32px; border-radius: 6px; width: 126px;"><div class="lg-health-widget-icon-parent" style="height: 16px; width: 16px;"><div class="lg-health-widget-icon AskAnExpert" role="img" aria-label="AskAnExpert" style="background-repeat: no-repeat; width: 32px; height: 32px; transform: translate(-7px, -7px) scale(0.5); background-image: url(&quot;/rp/s8oB_GhT-AU9pCcT3SdlZ45IdiY.png&quot;); background-position: -5px -5px;"></div></div><span class="lg-health-widget-content-item-text" style="text-overflow: ellipsis; overflow: hidden; text-wrap: nowrap; font-size: 12px; line-height: 14px; margin-top: 3px; color: rgb(102, 102, 102) !important;">Ask an expert</span></a></li></ul></div></nav><a id="HealthWidgetCtaBtn" class="b_widgetCtaBtn" target="_blank" href="https://www.bing.com/ck/a?!&amp;&amp;p=b0f5f3e4ca479f57JmltdHM9MTcyMTAwMTYwMCZpZ3VpZD0wNDAyNWQ1ZC04OWQzLTYyNDctMjQ2Ni00OTcyODgwMTYzMjcmaW5zaWQ9NTk0MA&amp;ptn=3&amp;ver=2&amp;hsh=3&amp;fclid=04025d5d-89d3-6247-2466-497288016327&amp;psq=pathology+meaning&amp;u=a1aHR0cHM6Ly93d3cubXNuLmNvbS9lbi1pbi9oZWFsdGgvPyZzb3VyY2U9aGVhbHRocW5hbGc&amp;ntb=1" h="ID=SERP,5940.1" style="color: rgb(255, 255, 255); margin: 8px 10px 0px; display: block; background-color: rgb(16, 110, 190); border-radius: 6px; cursor: pointer; border: none; padding: 5px; width: 124px; text-align: center; font-size: 13px; font-weight: 700; line-height: 20px;">Explore</a></div></div></div><div elementtiming="frp.TopOfPage" tabindex="-1" style="pointer-events: none; margin-top: -1px; height: 1px; width: 1px; font-size: 1px; position: absolute; top: 0px; right: 0px;">&nbsp;</div></li><li class="b_ans b_dictans" data-tag="" data-partnertag="" data-id="" data-fbhlsel="" h="SERP,5505.1" data-bm="7" style="border: 0px; border-collapse: collapse; border-spacing: 0px; list-style: none; margin: 0px 0px 10px; padding: 12px 20px 0px; color: rgb(113, 119, 125); font-family: Roboto, Helvetica, sans-serif;"><div id="b_dict_container" class="" style="--b-poleBackgroundColor: #036ac4; --b-dictionaryLineNewColor: #ddd; --b-dictionaryPronunciationTextColor: #444; --b-whiteBackground: #fff; --b-expButtonBackgroundColor: #106ebe; --b-dictionaryLabelBackgroundColor: #f5f5f5; --b-dictionaryLabelColor: #666; --b-dictionarySubLabelColor: #767676; --b-nymsBorderHover: #ccc; --b-nymsColorLinkable: #444; --b-audioIconColor: #106ebe; --b-nymsBorder: #ddd; --b-nymsBackgroundLinkable: #e9f3fb; --b-nymsBackgroundNonLinkable: #fff; --b-nymsColorNonLinkable: #707070; --b-dictionarySubTitleNewColor: #111; --b-expansionBackground: #fff; --b-dictExpansionButtonBkgrWhite: rgba(255,255,255,0);"><div class="dc_innerCont dc_HeightHidden" style="max-height: var(--b-height-size); height: fit-content; overflow: hidden; margin-bottom: -10px; --b-height-size: 516px;"><div class="b_entity b_dict" style="position: relative;"><div id="dc_topSection" class="noSrc" style="padding-bottom: 4px; display: flex;"><div id="dc_goWideHeader" style="display: inline-block; margin-right: 20px; float: left; width: 182.4px;"><div class="b_hPanel "><div><h3 style="border: 0px; border-collapse: collapse; border-spacing: 0px; list-style: none; margin-bottom: 0px; padding: 0px; display: inline-block; font-size: 18px; line-height: 22px; font-family: Roboto, sans-serif; color: var(--b-fontColor);">Dictionary</h3></div><div id="dc_footer"><div class="b_footnote" style="color: rgb(118, 118, 118); padding-bottom: 10px; font-size: 11px; line-height: 16px;">Data from&nbsp;<a target="_blank" href="https://www.bing.com/ck/a?!&amp;&amp;p=b86861069333ebfaJmltdHM9MTcyMTAwMTYwMCZpZ3VpZD0wNDAyNWQ1ZC04OWQzLTYyNDctMjQ2Ni00OTcyODgwMTYzMjcmaW5zaWQ9NTUyMg&amp;ptn=3&amp;ver=2&amp;hsh=3&amp;fclid=04025d5d-89d3-6247-2466-497288016327&amp;psq=pathology+meaning&amp;u=a1aHR0cHM6Ly9sYW5ndWFnZXMub3VwLmNvbS8&amp;ntb=1" h="ID=SERP,5522.1" style="color: rgb(64, 7, 162);">Oxford Languages</a></div></div></div></div><div class="dc_search" style="max-width: 70%; display: inline-block; min-width: 65%; float: right;"><div class="dcajx b_clearfix dcsbxhdr" data-priority="2" style="display: flex; margin-top: 0px; padding-bottom: 8px;"><a class="dictSearchBoxInstLink" tabindex="-1" title="Link for logging" h="ID=SERP,5944.1" style="color: rgb(64, 7, 162);"></a><div id="dictautodd" class="suggDD" data-sglsv="" data-sgac="false" data-sgurl="/wordfetch/as?q={query}" data-default-results-url="" aria-live="polite" aria-owns="sugg_drawer_dictautodd" style="position: relative; display: inline-block; width: 512px;"><input type="text" id="dictautodd_c" aria-label="Enter a word" name="dcipbox" maxlength="100" class="ctxt" data-gt="" placeholder="Enter a word" autocomplete="off" aria-autocomplete="both" aria-controls="sugg_drawer_dictautodd" style="font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; line-height: inherit; font-family: inherit; font-optical-sizing: inherit; font-kerning: inherit; font-feature-settings: inherit; font-variation-settings: inherit; font-size: 14px; color: rgb(68, 68, 68); border-color: rgb(221, 221, 221); padding-right: 11px; padding-left: 11px; height: 34px; border-width: 1px; border-style: solid; border-radius: 2px; vertical-align: middle; width: 279.913px;"></div><div class="dcbtn b_dmbtn b_highlighted" role="button" id="dc_searchbtn" tabindex="0" aria-label="Look it up" style="line-height: 32px; background: rgb(245, 245, 245); color: rgb(102, 102, 102); padding-left: 15px; padding-right: 15px; border-radius: 2px; cursor: pointer; border: 1px solid rgb(221, 221, 221); text-align: center; min-width: 70px; max-width: 200px; text-wrap: nowrap; overflow: hidden; text-overflow: ellipsis; margin-left: 10px;">Look&nbsp;</div></div></div></div></div></div></div></li>"></div>
            _unitofWork.SaveChanges();
            return true;
        }

        public string ViewPathTemplateReceipt(int PathReportId, int OP_IP_Type, string htmlFilePath, string htmlHeader)
        {
            // throw new NotImplementedException();

            SqlParameter[] para = new SqlParameter[2];

            para[0] = new SqlParameter("@PathReportId", PathReportId) { DbType = DbType.Int64 };
            para[1] = new SqlParameter("@OP_IP_Type", OP_IP_Type) { DbType = DbType.Int64 };
            var Bills = GetDataTableProc("m_rptPrintPathologyReportTemplate", para);
            string html = File.ReadAllText(htmlFilePath);
            
            html = html.Replace("{{CurrentDate}}", DateTime.Now.ToString("dd/MM/yyyy hh:mm tt"));
                // html = html.Replace("{{KamalHeader}}", Bills.GetColValue("HeaderName"));
            html = html.Replace("{{NewHeader}}", htmlHeader);
            StringBuilder items = new StringBuilder("");
            int i = 0;
            Boolean chkresonflag = false;

            html = html.Replace("{{RegNo}}", Bills.GetColValue("RegNo"));
            html = html.Replace("{{PatientName}}", Bills.GetColValue("PatientName"));
            html = html.Replace("{{AgeYear}}", Bills.GetColValue("AgeYear"));
            html = html.Replace("{{AdmissionTime}}", Bills.GetColValue("AdmissionTime").ConvertToDateString("dd/MM/yyyy | hh:mm tt"));
            html = html.Replace("{{PathTime}}", Bills.GetColValue("PathTime").ConvertToDateString("dd/MM/yyyy | hh:mm tt"));

            html = html.Replace("{{IPDNo}}", Bills.GetColValue("IPDNo"));
            html = html.Replace("{{GenderName}}", Bills.GetColValue("GenderName"));
            html = html.Replace("{{AgeMonth}}", Bills.GetColValue("AgeMonth"));
            html = html.Replace("{{AgeDay}}", Bills.GetColValue("AgeDay"));
            html = html.Replace("{{DoctorName}}", Bills.GetColValue("DoctorName"));
            html = html.Replace("{{RoomName}}", Bills.GetColValue("RoomName"));
            html = html.Replace("{{BedName}}", Bills.GetColValue("bedName"));
            html = html.Replace("{{DepartmentName}}", Bills.GetColValue("DepartmentName"));
            html = html.Replace("{{PatientType}}", Bills.GetColValue("PatientType"));
            html = html.Replace("{{RefDocName}}", Bills.GetColValue("RefDocName"));
            html = html.Replace("{{CompanyName}}", Bills.GetColValue("CompanyName"));


            html = html.Replace("{{GenderName}}", Bills.GetColValue("GenderName"));

            html = html.Replace("{{ConsultantDocName}}", Bills.GetColValue("ConsultantDocName"));
            html = html.Replace("{{PathTime}}", Bills.GetColValue("PathTime").ConvertToDateString());
            html = html.Replace("{{ReportTime}}", Bills.GetColValue("ReportTime").ConvertToDateString());
            html = html.Replace("{{RoomName}}", Bills.GetColValue("RoomName"));
            
            html = html.Replace("{{DepartmentName}}", Bills.GetColValue("DepartmentName"));
            html = html.Replace("{{RefDocName}}", Bills.GetColValue("RefDocName").ConvertToString());
            html = html.Replace("{{DoctorName}}", Bills.GetColValue("DoctorName").ConvertToString());
            html = html.Replace("{{ComapanyName}}", Bills.GetColValue("ComapanyName"));

            html = html.Replace("{{BedName}}", Bills.GetColValue("BedName"));
            html = html.Replace("{{Path_RefDoctorName}}", Bills.GetColValue("Path_RefDoctorName"));
            html = html.Replace("{{PathTemplateDetailsResult}}", Bills.GetColValue("PathTemplateDetailsResult").ConvertToString());
            html = html.Replace("{{PrintTestName}}", Bills.GetColValue("PrintTestName"));
            html = html.Replace("{{Path_DoctorName}}", Bills.GetColValue("Path_DoctorName"));

            
html = html.Replace("{{PathResultDr1}}", Bills.GetColValue("PathResultDr1"));
            //html = html.Replace("{{chkresonflag}}", Bills.GetColValue("reason").ConvertToString() != null ? "block" : "none");
            return html;

        }
    }
}

   